(this["webpackJsonpretrospective-board"]=this["webpackJsonpretrospective-board"]||[]).push([[0],{364:function(e,t,n){"use strict";n.r(t);var r,a=n(0),o=n.n(a),c=n(26),i=n.n(c),s=n(48),u=n(369),l=n(129),d=n.n(l),p=n(49),h=n.p+"static/media/logo.c8e6348b.png",b=n(2),f=n(14),j=n.n(f),v=n(32),O=n(5),m=n(6),x=n(143);!function(e){e.WENT_WELL="What Went Well",e.NEEDS_IMPROVEMENT="Needs To Be Improved",e.ACTION_ITEMS="Action Items",e.APPRECIATIONS="Appreciations"}(r||(r={}));var g=n(368),y=n(372),k=n(371),w=n(7);var E=function(e){var t=e.visible,n=e.initialValues,r=e.onCancel,o=e.onOk,c=g.a.useForm(),i=Object(O.a)(c,1)[0],s=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e;t&&(null===(e=s.current)||void 0===e||e.focus(),i.resetFields())}),[i,t]),Object(w.jsx)(y.a,{title:"Add Item",visible:t,destroyOnClose:!0,forceRender:!0,onCancel:r,onOk:function(){return i.submit()},children:Object(w.jsxs)(g.a,{autoComplete:"off",form:i,layout:"vertical",initialValues:n,onFinish:function(e){o(e),i.resetFields(),r()},children:[Object(w.jsx)(g.a.Item,{name:"title",label:"Title",rules:[{required:!0,message:"'Title' is required"},{max:100,message:"'Title' can not be longer than 100 characters"}],children:Object(w.jsx)(k.a,{ref:s,autoFocus:!0})}),Object(w.jsx)(g.a.Item,{name:"description",label:"Description",rules:[{required:!0,message:"'Description' is required"},{max:400,message:"'Description' can not be longer than 400 characters"}],children:Object(w.jsx)(k.a.TextArea,{rows:4})})]})})};var S=function(e){var t=e.visible,n=e.initialValues,r=e.onCancel,o=e.onOk,c=e.setAuth,i=g.a.useForm(),s=Object(O.a)(i,1)[0],u=Object(a.useRef)(null);Object(a.useEffect)((function(){var e;t&&(null===(e=u.current)||void 0===e||e.focus(),s.resetFields())}),[s,t]);var l=function(){var e=Object(v.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://pearson-retro.herokuapp.com/v1/auth/register",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:t.key}});case 2:return n=e.sent,e.next=5,n.json();case 5:if("true"!==(r=e.sent).success){e.next=16;break}e.prev=7,localStorage.setItem("secret",r.user.pkey),localStorage.setItem("uid",r.user.id),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(7),new Error("Failed setting the key");case 15:setTimeout((function(){c(!0)}),500);case 16:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsx)(y.a,{title:"Log In",visible:t,destroyOnClose:!0,forceRender:!0,onCancel:r,onOk:function(){return s.submit()},children:Object(w.jsx)(g.a,{autoComplete:"off",form:s,layout:"vertical",initialValues:n,onFinish:function(e){l(e),o(e),s.resetFields(),r()},children:Object(w.jsx)(g.a.Item,{name:"key",label:"Key",rules:[{required:!0,message:"'Key' is required"},{max:100,message:"'Key' can not be longer than 100 characters"}],children:Object(w.jsx)(k.a,{ref:u,autoFocus:!0})})})})},T=n(367),C=n(52),I=n(370),A=n(373),F=n(374),B=n(63);function N(){return D.apply(this,arguments)}function D(){return(D=Object(v.a)(j.a.mark((function e(){var t,n,r,a,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=null!==(r=localStorage.getItem("uid"))&&void 0!==r?r:"",e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new Error("Failed to read the uid");case 7:e.prev=7,t=null!==(a=localStorage.getItem("secret"))&&void 0!==a?a:"",e.next=14;break;case 11:throw e.prev=11,e.t1=e.catch(7),new Error("Failed to read key");case 14:return e.next=16,Object(B.a)((function(){return fetch("https://pearson-retro.herokuapp.com/v1/users/".concat(n),{headers:{Accept:"application/json","Content-Type":"application/json",Authorization:t}}).then((function(e){return e.json()}))}));case 16:if(!(o=e.sent).error){e.next=20;break}return console.error("Error getting the user",o.error),e.abrupt("return");case 20:return e.abrupt("return",o.data);case 21:case"end":return e.stop()}}),e,null,[[0,4],[7,11]])})))).apply(this,arguments)}function P(){return(P=Object(v.a)(j.a.mark((function e(t){var n,r,a,o,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=null!==(a=localStorage.getItem("uid"))&&void 0!==a?a:"",e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new Error("Failed to read the uid");case 7:e.prev=7,n=null!==(o=localStorage.getItem("secret"))&&void 0!==o?o:"",e.next=14;break;case 11:throw e.prev=11,e.t1=e.catch(7),new Error("Failed to read key");case 14:return e.next=16,Object(B.a)((function(){return fetch("https://pearson-retro.herokuapp.com/v1/users/".concat(r),{method:"PATCH",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:n}}).then((function(e){return e.json()}))}));case 16:if(!(c=e.sent).error){e.next=20;break}return console.error("Error updating user",c.error),e.abrupt("return");case 20:case"end":return e.stop()}}),e,null,[[0,4],[7,11]])})))).apply(this,arguments)}function z(e){return R.apply(this,arguments)}function R(){return(R=Object(v.a)(j.a.mark((function e(t){var n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=null!==(r=localStorage.getItem("secret"))&&void 0!==r?r:"",e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new Error("Failed to read key");case 7:return e.next=9,Object(B.a)((function(){return fetch("https://pearson-retro.herokuapp.com/v1/users/notes",{method:"POST",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:n}}).then((function(e){return e.json()}))}));case 9:if(!(a=e.sent).error){e.next=13;break}return console.error("Error creating note",a.error),e.abrupt("return");case 13:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function L(e){return M.apply(this,arguments)}function M(){return(M=Object(v.a)(j.a.mark((function e(t){var n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=null!==(r=localStorage.getItem("secret"))&&void 0!==r?r:"",e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new Error("Failed to read key");case 7:return e.next=9,Object(B.a)((function(){return fetch("https://pearson-retro.herokuapp.com/v1/users/notes/".concat(t.title),{method:"PATCH",body:JSON.stringify(t),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:n}}).then((function(e){return e.json()}))}));case 9:if(!(a=e.sent).error){e.next=13;break}return console.error("Error creating note",a.error),e.abrupt("return");case 13:return e.abrupt("return",a.data);case 14:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function W(){return(W=Object(v.a)(j.a.mark((function e(t,n){var r,a,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,r=null!==(a=localStorage.getItem("secret"))&&void 0!==a?a:"",e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new Error("Failed to read key");case 7:return e.next=9,Object(B.a)((function(){return fetch("https://pearson-retro.herokuapp.com/v1/users/notes/".concat(t),{method:"PATCH",body:JSON.stringify(n),headers:{Accept:"application/json","Content-Type":"application/json",Authorization:r}}).then((function(e){return e.json()}))}));case 9:if(!(o=e.sent).error){e.next=13;break}return console.error("Error updating note",o.error),e.abrupt("return");case 13:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}function V(){return(V=Object(v.a)(j.a.mark((function e(t){var n,r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,n=null!==(r=localStorage.getItem("secret"))&&void 0!==r?r:"",e.next=7;break;case 4:throw e.prev=4,e.t0=e.catch(0),new Error("Failed to read key");case 7:return e.next=9,Object(B.a)((function(){return fetch("https://pearson-retro.herokuapp.com/v1/users/notes/".concat(t.title),{method:"DELETE",headers:{Authorization:n}})}));case 9:if(!(a=e.sent).error){e.next=13;break}return console.error("Error deleting note",a.error),e.abrupt("return");case 13:case"end":return e.stop()}}),e,null,[[0,4]])})))).apply(this,arguments)}var q=n(375),J=n(376),_=n(197),H=n(377),K=n(378),Z=n(86),G=n(62);var Q,U,X,Y=function(e){return Object(w.jsx)(G.a,Object(b.a)({mouseEnterDelay:1.5},e))},$=Object(p.a)(T.a)(Q||(Q=Object(s.a)(["\n  margin: 0.5rem;\n  padding: 0.5rem;\n  background-color: '#fff';\n"]))),ee=Object(p.a)(u.a.Title)(U||(U=Object(s.a)(['\n  white-space: pre-wrap;\n  // To make ellipsis of the title visible.\n  // Without this margin, it can be go behind the "extra" component.\n  // So, we give it a little space.\n  margin-right: 0.25rem;\n']))),te=Object(p.a)(I.a.Item)(X||(X=Object(s.a)(["\n  color: ",";\n"])),Z.red.primary);var ne,re=function(e){var t,n=e.item,r=e.status,o=e.onEdit,c=e.uid,i=e.onDelete,s=e.likedNotes,l=Object(a.useState)((null===(t=n.likedBy)||void 0===t?void 0:t.length)||0),d=Object(O.a)(l,2),p=d[0],h=d[1],b=Object(a.useState)(!1),f=Object(O.a)(b,2),m=f[0],x=f[1],g=Object(a.useState)(""),k=Object(O.a)(g,2),E=(k[0],k[1]),S=Object(a.useRef)(!0);return Object(a.useEffect)((function(){var e;if(S.current)return(null===(e=n.likedBy)||void 0===e?void 0:e.includes(c||""))&&x(!0),void(S.current=!1);n.createdBy&&E(n.createdBy),n.id&&function(e){P.apply(this,arguments)}({likedNotes:[n.id]}),function(){var e=Object(v.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L({createdBy:"",parent:r,title:n.title,likes:null===s||void 0===s?void 0:s.length,description:n.description,likedBy:{uid:c||"",pos:m?1:0}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[m]),Object(w.jsx)($,{size:"small",title:Object(w.jsx)(Y,{overlay:n.title,children:Object(w.jsx)("span",{children:Object(w.jsx)(ee,{level:5,ellipsis:{rows:7},children:n.title})})}),extra:Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(C.a,{style:{marginLeft:".4em",border:"none"},size:"small",onClick:function(){n.id&&n.createdBy!==c&&(x(!m),h(m?p-1:p+1))},icon:m?Object(w.jsx)(q.a,{style:{color:"#1690ff"}}):Object(w.jsx)(J.a,{})}),Object(w.jsx)(A.a,{count:p,showZero:!0,offset:[-5,-21],style:{opacity:p?1:0,border:"1px solid rgb(230 230 230)",backgroundColor:"rgb(230, 247, 255)",color:"rgb(24, 144, 255)"}}),Object(w.jsx)(F.a,{overlay:Object(w.jsxs)(I.a,{children:[Object(w.jsx)(I.a.Item,{icon:Object(w.jsx)(_.a,{}),onClick:function(){return o(n,r)},disabled:n.createdBy!==c,children:"Edit"}),Object(w.jsx)(te,{icon:Object(w.jsx)(H.a,{}),disabled:n.createdBy!==c,onClick:function(){return y.a.confirm({title:"Delete?",content:'Are you sure to delete "'.concat(n.title,'"?'),onOk:function(){return i({status:r,itemToDelete:n})}})},children:"Delete"})]}),trigger:["click"],children:Object(w.jsx)(C.a,{style:{marginLeft:".4em"},size:"small",icon:Object(w.jsx)(K.a,{})})})]}),children:Object(w.jsx)(Y,{overlay:n.description,children:Object(w.jsx)(u.a.Paragraph,{type:"secondary",ellipsis:{rows:50},children:n.description})})})},ae=Object(p.a)(T.a)(ne||(ne=Object(s.a)(["\n  user-select: none;\n  flex: 1;\n  margin: 0.5rem;\n  display: flex;\n  flex-direction: column;\n  // To force each flex item to have equal width\n  // even if they have long texts with no spaces etc.\n  min-width: 0;\n  > .ant-card-body {\n    overflow: hidden;\n    height: 100%;\n    padding: 0;\n  }\n"])));var oe,ce,ie,se=function(e){var t=e.items,n=e.status,r=e.onClickAdd,a=e.onEdit,o=e.onDelete,c=e.likedNotes,i=e.uid;return Object(w.jsx)(ae,{title:"".concat(n," (").concat(t.length,")"),extra:r&&Object(w.jsx)(C.a,{type:"primary",style:{background:"#017fa3",borderColor:"#017fa3"},onClick:r,children:"Add"}),children:t.map((function(e,t){return Object(w.jsx)("div",{children:Object(w.jsx)(re,{uid:i,likedNotes:c,item:e,status:n,onEdit:a,onDelete:o})},e.id)}))})},ue=p.a.div(oe||(oe=Object(s.a)(["\n  min-height: 0;\n  height: 100%;\n  min-width: 800px;\n  max-width: 2400px;\n  margin: auto;\n"]))),le=p.a.div(ce||(ce=Object(s.a)(["\n  height: 100%;\n  padding: 0.5rem;\n  display: flex;\n  justify-content: space-around;\n"]))),de=(ie={},Object(m.a)(ie,r.WENT_WELL,[]),Object(m.a)(ie,r.NEEDS_IMPROVEMENT,[]),Object(m.a)(ie,r.ACTION_ITEMS,[]),Object(m.a)(ie,r.APPRECIATIONS,[]),ie);var pe,he,be,fe=function(){var e=function(e,t){var n,r=Object(a.useState)(),o=Object(O.a)(r,2),c=o[0],i=o[1];try{var s;n=null!==(s=localStorage.getItem("secret"))&&void 0!==s?s:""}catch(u){throw new Error("Failed to read key")}return Object(a.useEffect)((function(){!function(){var e=Object(v.a)(j.a.mark((function e(){var r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(B.a)((function(){return fetch("https://pearson-retro.herokuapp.com/v1/users/notes",{headers:{Authorization:n}}).then((function(e){return e.json()}))}));case 2:if(!(r=e.sent).error){e.next=6;break}return console.error("Error fetching notes",r.error),e.abrupt("return");case 6:a={},r.data.results&&r.data.results.map((function(e){a[e.parent]?a[e.parent].push(e):a[e.parent]=[e]})),i(Object(b.a)(Object(b.a)({},t),a));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t,n]),[c||t,i]}(0,de),t=Object(O.a)(e,2),n=t[0],o=t[1],c=Object(a.useState)(!1),i=Object(O.a)(c,2),s=i[0],u=i[1],l=Object(a.useState)(!1),d=Object(O.a)(l,2),p=d[0],h=d[1],f=Object(a.useState)(""),m=Object(O.a)(f,2),g=m[0],y=m[1],k=Object(a.useState)([]),T=Object(O.a)(k,2),C=T[0],I=T[1],A=function(){var e=Object(a.useRef)(!0);return Object(a.useEffect)((function(){e.current=!1}),[]),e.current}();Object(a.useEffect)((function(){function e(){return(e=Object(v.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:t=e.sent,I(null===t||void 0===t?void 0:t.likedNotes);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}A&&function(){e.apply(this,arguments)}()}),[A]),Object(a.useEffect)((function(){try{var e=localStorage.getItem("secret"),t=localStorage.getItem("uid");y(t),h(!!e)}catch(n){throw new Error("Failed getting the key")}}),[p,h]);var F=Object(a.useState)(null),D=Object(O.a)(F,2),P=D[0],R=D[1],L=Object(a.useState)(null),M=Object(O.a)(L,2),q=M[0],J=M[1],_=function(e,t){R(t),J(e),u(!0)},H=function(){J(null),u(!1)},K=function(e){var t=e.status,n=e.itemToDelete;!function(e){V.apply(this,arguments)}(n),o((function(e){return Object(x.a)(e,(function(e){e[t]=e[t].filter((function(e){return e.id!==n.id}))}))}))},Z=Object(a.useMemo)((function(){var e,t,n,r,a,o;return{title:null!==(e=null===q||void 0===q?void 0:q.title)&&void 0!==e?e:"",createdBy:null!==(t=null===q||void 0===q?void 0:q.createdBy)&&void 0!==t?t:"",id:null!==(n=null===q||void 0===q?void 0:q.id)&&void 0!==n?n:"",description:null!==(r=null===q||void 0===q?void 0:q.description)&&void 0!==r?r:"",likes:null!==(a=null===q||void 0===q?void 0:q.likes)&&void 0!==a?a:0,likedBy:null!==(o=null===q||void 0===q?void 0:q.likedBy)&&void 0!==o?o:[]}}),[q]);return p?Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(ue,{children:Object(w.jsx)(le,{children:Object.values(r).map((function(e){return Object(w.jsx)(se,{uid:g,likedNotes:C,status:e,items:n[e],onClickAdd:function(){return _(null,e)},onEdit:_,onDelete:K},e)}))})}),Object(w.jsx)(E,{visible:s,onCancel:H,onOk:function(e){o((function(t){return Object(x.a)(t,(function(t){if(q){var n,a=Object.values(t).flatMap((function(e){return e})).find((function(e){return e.id===q.id}));if(a)!function(e,t){W.apply(this,arguments)}(a.title,{parent:P||"",title:e.title,description:e.description,createdBy:"",likes:null!==(n=null===q||void 0===q?void 0:q.likes)&&void 0!==n?n:0,likedBy:{uid:null!==g&&void 0!==g?g:"",pos:3}}),a.title=e.title,a.description=e.description,a.id=e.id}else for(var o in r)r[o]===P&&(z({likedBy:{uid:g||"",pos:0},createdBy:g||"",parent:r[o],title:e.title,likes:0,description:e.description}),t[r[o]].push(Object(b.a)({},e)))}))}))},initialValues:Z})]}):Object(w.jsx)(S,{onCancel:H,visible:!0,onOk:function(e){},initialValues:Z,setAuth:h})},je=Object(p.a)(d.a)(pe||(pe=Object(s.a)(['\n  /* We can\'t use "height: 100vh; width: 100vw;" here.\n  Otherwise, when there is a horizontal scrollbar etc, \n  because that we set a constant height, there will be a vertical one too.  */\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  right: 0;\n']))),ve=Object(p.a)(l.Header)(he||(he=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  background-color: #fff;\n  padding-top: 1em;\n  padding-left: 0;\n"]))),Oe=Object(p.a)(l.Content)(be||(be=Object(s.a)(["\n  background-color: ",";\n"])),"#017fa3"[6]);var me=function(){return Object(w.jsxs)(je,{children:[Object(w.jsxs)(ve,{children:[Object(w.jsx)("img",{src:h,style:{height:"50px",padding:"0 1em 1em 1em"},alt:"pearson logo"}),Object(w.jsx)(u.a.Title,{level:3,type:"secondary",children:"Prizm Retrospective Board"})]}),Object(w.jsx)(Oe,{children:Object(w.jsx)(fe,{})})]})},xe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,379)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,o=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),o(e),c(e)}))};n(363);i.a.render(Object(w.jsx)(o.a.StrictMode,{children:Object(w.jsx)(me,{})}),document.getElementById("root")),xe()}},[[364,1,2]]]);
//# sourceMappingURL=main.612a5815.chunk.js.map